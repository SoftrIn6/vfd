<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet Dashboard</title>
    <style>
        /* Your existing CSS */
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <img src="logo.png" alt="Logo" class="logo-img">
                <span class="logo-text">Dashboard</span>
            </div>
        </div>

        <div class="user-profile">
            <div class="user-avatar"><i class="fas fa-user"></i></div>
            <div class="user-info">
                <div class="username" id="username"></div>
                <div class="user-email" id="email"></div>
            </div>
        </div>

        <div class="assets-section">
            <div class="section-title">
                <span>Wallet Balance</span>
                <span class="refresh-btn" onclick="fetchUserData()">Refresh</span>
            </div>
            <div class="total-assets" id="accountBalance">$0.00</div>
            <div class="assets-grid">
                <div class="asset-item">
                    <div class="asset-label">Quantitative Account</div>
                    <div class="asset-value" id="quantitativeAccount">$0.00</div>
                </div>
                <div class="asset-item">
                    <div class="asset-label">Smart Account</div>
                    <div class="asset-value" id="smartAccount">$0.00</div>
                </div>
                <div class="asset-item">
                    <div class="asset-label">Total Revenue</div>
                    <div class="asset-value" id="totalRevenue">$0.00</div>
                </div>
                <div class="asset-item">
                    <div class="asset-label">Yesterday's Earnings</div>
                    <div class="asset-value" id="yesterdayEarnings">$0.00</div>
                </div>
                <div class="asset-item">
                    <div class="asset-label">Today's Earnings</div>
                    <div class="asset-value" id="todaysEarnings">$0.00</div>
                </div>
                <div class="asset-item">
                    <div class="asset-label">Commission</div>
                    <div class="asset-value" id="commission">$0.00</div>
                </div>
            </div>
        </div>
        
        <button onclick="logout()">Logout</button>

    </div>

    <script>
        function fetchUserData() {
            const email = sessionStorage.getItem("userEmail");
            const token = sessionStorage.getItem("sessionToken");

            if (!email || !token) {
                alert("No user session found. Redirecting to login.");
                window.location.href = "login.html"; // Redirect to login page
                return;
            }

            google.script.run.withSuccessHandler(updateUI).getUserData(email, token);
        }

        function updateUI(response) {
            if (response.status === "success") {
                const userData = response.userData;
                document.getElementById("username").innerText = userData.Username;
                document.getElementById("email").innerText = userData.Email;
                document.getElementById("accountBalance").innerText = `$${userData["Account Balance"]}`;
                document.getElementById("quantitativeAccount").innerText = `$${userData["Quantitative Account"]}`;
                document.getElementById("smartAccount").innerText = `$${userData["Smart Account"]}`;
                document.getElementById("totalRevenue").innerText = `$${userData["Total Revenue"]}`;
                document.getElementById("yesterdayEarnings").innerText = `$${userData["Yesterday's Earnings"]}`;
                document.getElementById("todaysEarnings").innerText = `$${userData["Today's Earnings"]}`;
                document.getElementById("commission").innerText = `$${userData["Commission"]}`;
            } else {
                alert(response.message);
            }
        }

        function logout() {
            sessionStorage.clear();
            alert("Logged out successfully.");
            window.location.href = "login.html"; // Redirect to login
        }

        window.onload = fetchUserData;
    </script>
</body>
</html>
